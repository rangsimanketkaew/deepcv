# Use CP2K with PLUMED for Metadynamics Simulation

## Prepare all necessary files

The following is a list of files for metadynamics simulation of Diels-Alder reaction using DFT-MD
at the xTB level with D3 correction.

```sh
$ tree

.
├── MetaD.inp              # CP2K input file
├── plumed_deepcv.dat      # PLUMED input file generated by deepcv2plumed module
├── reactant_DA_water.xyz  # Coordinates of a starting reactant
```

In `MetaD.inp`, specify the following input deck in `&METADYN` section.
See [MetaD.inp](https://gitlab.uzh.ch/lubergroup/deepcv/-/blob/master/input/MetaD.inp) as an example.

```
# Import PLUMED input file
&MOTION
    &FREE_ENERGY
        &METADYN
            USE_PLUMED .TRUE.
            PLUMED_INPUT_FILE plumed_deepcv.dat
        &END METADYN
    &END FREE_ENERGY
%END MOTION
```

where `plumed_deepcv.dat` is the file generated by DeepCV `deepcv2plumed` module in the previous step.

## Run a metadynamics simulation using CP2K

In order to run metadynamics using CP2K and PLUMED, make sure that your CP2K is compiled with PLUMED that supports
[SPRINT module](https://www.plumed.org/doc-v2.9/user-doc/html/_s_p_r_i_n_t.html).

```sh
cp2k-8.2-Linux-x86_64.ssmp -i MetaD.inp -o MetaD.out &
```

CP2K is an open-source quantum chemistry and solid state physics software for performing atomistic simulations.
CP2K source code can be obtained free of charge: https://www.cp2k.org.
